generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model MedicalFacility {
  id           String       @id @default(cuid())
  facilityType String
  name         String
  postalCode   String
  address      String
  districtName String
  phoneNumber  String?
  latitude     Float
  longitude    Float

  departments Department[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([districtName])
  @@index([facilityType])
}

model Department {
  id                String          @id @default(cuid())
  facilityId        String
  facility          MedicalFacility @relation(fields: [facilityId], references: [id], onDelete: Cascade)

  departmentName    String
  consultationHours String?
  hasNightService   Boolean         @default(false)
  hasWeekendService Boolean         @default(false)
  hasHomeVisit      Boolean         @default(false)

  @@index([departmentName])
  @@index([facilityId])
}

model RealEstateTransaction {
  id           String   @id @default(cuid())
  districtName String
  districtCode String

  tradePrice   Int
  propertyType String
  floorPlan    String?
  area         Float
  buildingYear String?
  structure    String?

  year    String
  quarter String
  period  String

  createdAt DateTime @default(now())

  @@index([districtName])
  @@index([propertyType])
  @@index([year, quarter])
  @@index([districtName, propertyType])
}

model DistrictMedicalScore {
  id             String @id @default(cuid())
  districtName   String @unique

  childcareScore Int
  elderlyScore   Int
  generalScore   Int
  overallScore   Int

  scoreDetails String

  hospitalCount Int
  clinicCount   Int
  dentalCount   Int
  pharmacyCount Int

  calculatedAt DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([overallScore])
}
