# MediHome 仕様書

**東京23区 医療アクセス格差マップ**

**最終更新**: 2026年1月

---

## 概要

MediHomeは、東京23区の医療アクセス格差を可視化するWebサービスです。子育て世帯・高齢者・一般向けの3つの視点から医療環境を評価し、引っ越し先選びの参考情報を提供します。

### ターゲットユーザー

- 引っ越しを検討している子育て世帯・シニア世帯
- 「次に住む街」の医療環境を知りたい人

### コア機能

1. **医療アクセススコア地図**: 23区を色分けした地図（緑=充実、赤=不足）
2. **ライフステージ別フィルター**: 子育て向け（小児科重視）、高齢者向け（訪問診療重視）、一般向け
3. **格差の可視化ダッシュボード**: TOP5/WORST5ランキング、統計サマリー

---

## 技術スタック

### フロントエンド

- Next.js 16.0.10（App Router）
- TypeScript
- React 19.2.1
- Leaflet + React Leaflet（地図表示）
- TailwindCSS v4

### バックエンド・データベース

- Prisma ORM 5.7.0
- SQLite（開発環境）

### 開発ツール

- tsx（TypeScript実行）
- csv-parse（CSVパース）

---

## データ

### データソース

- **医療施設情報**: 厚生労働省 医療情報ネット オープンデータ
- **地図データ**: OpenStreetMap

### データ概要

| 項目 | 値 |
|------|-----|
| 対象エリア | 東京23区 |
| 施設総数 | 20,927施設 |
| 病院 | 393件 |
| 診療所 | 9,381件 |
| 歯科 | 6,400件 |
| 薬局 | 4,753件 |
| 診療科数 | 48,180件 |
| データ更新日 | 2025年12月1日 |

### ライセンス

- 医療データ: 政府標準利用規約（第2.0版）/ CC BY 4.0互換
- 地図データ: Open Database License (ODbL)

---

## スコア計算

スコアは**面積あたりの密度**（施設数/km²）を基準に、**23区間での相対的なパーセンタイル順位**で算出されます。

### 計算方式

1. 各区の面積データ（km²）を使用
2. 施設・診療科の密度を計算（件数 ÷ 面積）
3. 23区内での順位をパーセンタイルスコア（0-100）に変換
4. 各指標の重み付け平均を算出

### 子育てスコア（childcareScore）

| 指標 | 重み |
|------|------|
| 小児科密度（施設数/km²） | 35% |
| 夜間小児科の有無 | 15% |
| 産婦人科・助産所密度 | 20% |
| 薬局密度 | 15% |
| 病院有無（2件以上=100点、1件=50点、0件=0点） | 15% |

### 高齢者スコア（elderlyScore）

| 指標 | 重み |
|------|------|
| 循環器内科密度 | 25% |
| 整形外科密度 | 25% |
| リハビリ科密度 | 25% |
| 病院密度 | 25% |

### 一般医療スコア（generalScore）

| 指標 | 重み |
|------|------|
| 内科密度 | 25% |
| 歯科密度 | 20% |
| 薬局密度 | 20% |
| 診療所密度 | 20% |
| 診療科の多様性（種類数） | 15% |

### 総合スコア（overallScore）

3カテゴリの単純平均値

### 参考：東京23区面積（km²）

千代田区 11.66 / 中央区 10.21 / 港区 20.37 / 新宿区 18.22 / 文京区 11.29 / 台東区 10.11 / 墨田区 13.77 / 江東区 40.16 / 品川区 22.84 / 目黒区 14.67 / 大田区 60.83 / 世田谷区 58.05 / 渋谷区 15.11 / 中野区 15.59 / 杉並区 34.06 / 豊島区 13.01 / 北区 20.61 / 荒川区 10.16 / 板橋区 32.22 / 練馬区 48.08 / 足立区 53.25 / 葛飾区 34.80 / 江戸川区 49.90

---

## ディレクトリ構成

```
medihome/
├── data/
│   └── mhlw/                    # 厚労省オープンデータ（CSV）
├── prisma/
│   ├── schema.prisma            # データベーススキーマ
│   └── dev.db                   # SQLiteデータベース
├── scripts/
│   ├── fetch-mhlw-opendata.ts   # データダウンロード
│   ├── import-mhlw-tokyo.ts     # データインポート
│   └── calculate-district-scores.ts  # スコア計算
├── src/
│   ├── app/                     # Next.js App Router
│   │   ├── page.tsx             # トップページ（ダッシュボード）
│   │   ├── search/page.tsx      # 検索結果ページ
│   │   ├── api/                 # API Routes
│   │   └── legal/               # 法的ページ
│   ├── components/              # Reactコンポーネント
│   ├── lib/                     # ユーティリティ関数
│   └── types/                   # TypeScript型定義
└── doc/
    └── specification.md         # 本ファイル
```

---

## npm スクリプト

| コマンド | 説明 |
|---------|------|
| `npm run dev` | 開発サーバー起動（port 4000） |
| `npm run build` | 本番ビルド |
| `npm run fetch:mhlw` | 厚労省データダウンロード |
| `npm run import:mhlw` | データインポート |
| `npm run calculate:scores` | スコア計算 |
| `npm run setup:mhlw` | 上記3つを一括実行 |
| `npm run db:studio` | Prisma Studio起動 |

---

## API

### GET /api/districts

全区のスコア一覧を取得

### GET /api/scores/[district]

指定区の詳細スコアを取得

### GET /api/facilities/[district]

指定区の医療施設一覧を取得

---

## 法的対応

### 免責事項

- 医療施設情報は参考情報であり、最新情報は各医療機関に要確認
- スコアは客観的指標に基づく参考値であり、医療の質を保証するものではない

### 出典表示

- 厚生労働省 医療情報ネット
- OpenStreetMap contributors

---

## 今後の拡張（スコープ外）

- 全国展開（23区以外）
- 時系列データ（医療機関の増減トレンド）
- API提供（B2B）
